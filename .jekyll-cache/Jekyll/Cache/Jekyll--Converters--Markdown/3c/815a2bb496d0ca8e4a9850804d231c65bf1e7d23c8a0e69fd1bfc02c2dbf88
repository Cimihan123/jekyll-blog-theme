I"á<h3 id="challenge-description">Challenge Description</h3>

<!-- excerpt-start -->
<p><span style="font-size:30px;">O</span>ne of our clients informed us they recently suffered an employee data breach. As a startup company, they had a constrained budget allocated for security and employee  <!-- excerpt-end --> training. I visited them and spoke with the relevant stakeholders. I also collected some suspicious emails and a USB drive an employee found on their premises. While I am analyzing the suspicious emails, can you check the contents on the USB drive?</p>

<p>Â 
Â 
Â </p>

<p><strong>1. What file is the autorun.inf running?</strong></p>

<p>â†’ README.pdf</p>

<p><img src="/assets/img/blog1/1.png" alt="autorun &gt;&lt;" class="center" /></p>

<p>autorun.infâ€Š-â€ŠItâ€™s a text file that can be used to automatically run some applications or load when some media like usb,cd/dvd is inserted.</p>

<p><img src="/assets/img/blog1/1p2.png" alt="autorun &gt;&lt;" class="left" /></p>

<p>For more info you can visit this link. <a href="https://www.samlogic.net/articles/autorun-commands.htm">Click Here </a></p>

<p>Â 
Â </p>

<p><strong>2. Does the pdf file pass virustotal scan? (No malicious results returned)</strong></p>

<p>â†’ False</p>

<p>As it also scans pdfs which is obvious.</p>

<p><img src="/assets/img/blog1/2.png" alt="scan &gt;&lt;" class="left" /></p>

<p>The pdf is utterly suspected as malicious.</p>

<p><img src="/assets/img/blog1/3.png" alt="virtustotalscan &gt;&lt;" class="left" /></p>

<p>Â 
Â </p>

<p><strong>3. Does the file have the correct magicÂ number?</strong></p>

<p>â†’ True</p>

<p>To check the signatureÂ , visit here: <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">Click Here</a>
<img src="/assets/img/blog1/4.png" alt=" signature &gt;&lt;" class="left" />
The magic bytes matches with pdf magic bytes so the file has correct magic number.</p>

<p>Letâ€™s first analyze the pdf file with a tool pdfid.
https://blog.didierstevens.com/programs/pdf-tools</p>

<p>Â </p>

<!-- <pre>
<b style="color:black;" > -->
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Pageâ€Š-â€Šthe number of pages in pdf

/Encryptâ€Š-â€Šstipulates a password need to be read

/ObjStmâ€Š-â€Šobject streams

/Jsâ€Š-â€Špdf file may contains js code which could be malicious to open

/AA and /OpenActionâ€Š-â€Šaction that will carried out automatically when we open a pdf file. Could automatically launch malicious js commands

/AcroFormâ€Š-â€Špdf form authored with Adobe Acrobat Pro/Standard

/JBIG2Decodeâ€Š-â€Šindicates pdf uses JBIG2Decode compression

/RichMediaâ€Š-â€Šuse to embed files,videos etc on pdf

/Launchâ€Š-â€Što lauch some actions

/EmbeddedFileâ€Š-â€Šcontains some external files

/XFAâ€Š-â€ŠXML Forms Architecture

/URIâ€Š-â€ŠUrl to access
</code></pre></div></div>
<!-- </b> 
</pre> -->

<p><img src="/assets/img/blog1/5.png" alt=" pdfidresult &gt;&lt;" class="left" /></p>

<p>As we see it has some js contents which will automatically open on opening the pdf file and that seems particularly malicious.
The same type of result can be obtained via peepdf tool.
Here is the link: <a href="https://eternal-todo.com/tools/peepdf-pdf-analysis-tool">Click Here</a> tut for this tool. You can also download the tool if you want.Â :) Btw it only runs in python2.
<img src="/assets/img/blog1/6.png" alt=" peepdf &gt;&lt;" class="left" /></p>

<p>â€œpdf-parserâ€Š-â€ŠThis tool will parse a PDF document to identify the fundamental elements used in the analyzed file. It will not render a PDF document.â€
On checking each objectsÂ , the object 28 seems rather interesting than other.
This is just my guess could be wrong.</p>

<p>/Fâ€Š-â€Šindicates file</p>

<p>/Dâ€Š-â€Šindicates directory</p>

<p>/Pâ€Š-â€Šindicates path</p>

<p><img src="/assets/img/blog1/7.png" alt=" peepdf &gt;&lt;" class="left" /></p>

<p>Â 
Â </p>

<p><strong>4. What OS type can the file exploit? (Linux, MacOS, Windows,Â etc)</strong></p>

<p>â†’ Windows</p>

<p>Â 
Â </p>

<p><strong>5. A Windows executable is mentioned in the pdf file, what isÂ it?</strong></p>

<p>â†’ cmd.exe</p>

<p>Â 
Â </p>

<p><strong>6. How many suspicious /OpenAction elements does the fileÂ have?</strong></p>

<p>â†’ 1</p>

<p>Â 
Â </p>

<p>Thank YouÂ :)</p>

:ET